@page "/"
@inject IImageService ImageService
@implements IDisposable

<div class="grid grid-cols-4 gap-4 p-4">
    @foreach (var img in _images)
    {
        <p>foobar</p>
        <div class="relative">
            <img src="@img.Url" alt="@img.Title" class="w-full h-48 object-cover rounded-lg" />
            @if (!string.IsNullOrEmpty(img.Title))
            {
                <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white p-2 rounded-b-lg">
                    @img.Title
                </div>
            }
        </div>
    }
</div>

@code {
    private List<ImageModel> _images { get; set; } = new()
    {
    };
    
    protected override void OnInitialized()
    {
        ImageService.NewImagesFound += SetImages; 
    }

    private async Task SetImages()
    {
        _images = ImageService.GetImages();

        await InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        //ImageService.NewImagesFound -= SetImages;
    }
}